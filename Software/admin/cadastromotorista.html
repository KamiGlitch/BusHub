<!DOCTYPE html>
<html>

<head>

    <meta charset='utf-8'>
    <meta name="author" content="etec-c">
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>

    <title>Cadastro de Motoristas</title>

    <script src="https://kit.fontawesome.com/c8de44c573.js" crossorigin="anonymous"></script>

    <!-- <link rel="stylesheet" href="../../bootstrap-5.3.0-dist/bootstrap-5.3.0-dist/css/bootstrap.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="../assets/css/admin.css">
    <!-- <link rel="stylesheet" href="../css/styleimg.css"> -->
    <style>
      @font-face {
          font-family: Made Tommy;
        
          src: url(../Madetommy.otf);
      }
  </style>

</head>

<body class="page-admin">



    <header>
      <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
          <!-- <a href="../index.html">
            <img src="../images/icone_v1.png" width="35" height="45" class="d-inline-block align-top" alt="">
          </a> -->
          <a href="">
            <img src="../images/icone_v1.png" width="35" height="45" class="d-inline-block align-top" alt="">
          </a>

          <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
            data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
            aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">

              

              <div class="container text-center grid gap-0 column-gap-3">
                <div class="row align-items-start">
  
                  <div class="col g-col-6">
                    <li class="nav-item">
                      <a class="nav-link active" aria-current="page" href="cadastromotorista.html">Cadastro Motorista</a>
                    </li>
                  </div>
  
               
  
                  <div class="col g-col-6">
                    <li class="nav-item">
                      <a class="nav-link active" href="cadastrolinhas.html">Cadastro Linhas</a>
                    </li>
                  </div>
  
                  <div class="col g-col-6">
                    <li class="nav-item">
                      <a class="nav-link active" href="cadastroponto.html">Cadastro Ponto</a>
                    </li>
                  </div>

                  <div class="col g-col-6">
                    <li class="nav-item">
                      <a class="nav-link active" href="cadastrohorario.html">Cadastro Horários</a>
                    </li>
                  </div>
  
  
                </div>
              </div>
          </div>

          </ul>
        </div>


      </nav>
    </header>
<main>
<section class="forms-cadastro">
<div class ="container-left">
    <div class = "box pr-2">
        <div class="mb-3 row justify-content-between">
            <div class = "col-sm-8">
              <div >
                <Label class="labelcampo">
                   Nome do Motorista
                </Label>

                      <input class="form-control w-100" type="text" placeholder="Adoaldo Nascimento Oliveira" id="nome_mot" required>
              </div>
          </div>
          <div class="col-sm-4">
            <div class="form-button-ra">
              <Label class="labelcampo">
                  RA
              </Label>

                    <input class="form-control w-100" type="text" placeholder="ex: 12738894" id="RA_mot" maxlength="8" onchange="select()" required>
                    <button type="button" class="btn-success" onclick="select()">
                      <i class="icon search">
                        <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0,0,256,256">
                          <g fill-opacity="0.45098" fill="#000000" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(2,2)"><path d="M52.34961,14.40039c-9.725,0 -19.44961,3.69961 -26.84961,11.09961c-14.8,14.8 -14.8,38.89922 0,53.69922c7.4,7.4 17.10039,11.10156 26.90039,11.10156c9.8,0 19.50039,-3.70156 26.90039,-11.10156c14.7,-14.8 14.69844,-38.89922 -0.10156,-53.69922c-7.4,-7.4 -17.12461,-11.09961 -26.84961,-11.09961zM52.30078,20.30078c8.2,0 16.39961,3.09844 22.59961,9.39844c12.5,12.5 12.49961,32.80078 0.09961,45.30078c-12.5,12.5 -32.80078,12.5 -45.30078,0c-12.5,-12.5 -12.5,-32.80078 0,-45.30078c6.2,-6.2 14.40156,-9.39844 22.60156,-9.39844zM52.30078,26.30078c-6.9,0 -13.40078,2.69922 -18.30078,7.69922c-4.7,4.7 -7.29961,10.80039 -7.59961,17.40039c-0.1,1.7 1.20039,2.99961 2.90039,3.09961h0.09961c1.6,0 2.9,-1.30039 3,-2.90039c0.2,-5.1 2.29883,-9.80039 5.79883,-13.40039c3.8,-3.8 8.80156,-5.89844 14.10156,-5.89844c1.7,0 3,-1.3 3,-3c0,-1.7 -1.3,-3 -3,-3zM35,64c-1.65685,0 -3,1.34315 -3,3c0,1.65685 1.34315,3 3,3c1.65685,0 3,-1.34315 3,-3c0,-1.65685 -1.34315,-3 -3,-3zM83.36328,80.5c-0.7625,0 -1.5125,0.30039 -2.0625,0.90039c-1.2,1.2 -1.2,3.09922 0,4.19922l2.5,2.5c-0.6,1.2 -0.90039,2.50039 -0.90039,3.90039c0,2.4 0.89961,4.70039 2.59961,6.40039l12.80078,12.59961c1.8,1.8 4.09844,2.69922 6.39844,2.69922c2.3,0 4.60039,-0.89961 6.40039,-2.59961c3.5,-3.5 3.5,-9.19922 0,-12.69922l-12.79883,-12.80078c-1.7,-1.7 -4.00039,-2.59961 -6.40039,-2.59961c-1.4,0 -2.70039,0.30039 -3.90039,0.90039l-2.5,-2.5c-0.6,-0.6 -1.37422,-0.90039 -2.13672,-0.90039zM91.90039,88.90039c0.8,0 1.59961,0.30039 2.09961,0.90039l12.69922,12.69922c1.2,1.2 1.2,3.09922 0,4.19922c-1.2,1.2 -3.09922,1.2 -4.19922,0l-12.69922,-12.59961c-0.6,-0.6 -0.90039,-1.39922 -0.90039,-2.19922c0,-0.8 0.30039,-1.59961 0.90039,-2.09961c0.6,-0.6 1.29961,-0.90039 2.09961,-0.90039z"></path></g></g>
                          </svg>
                      </i>
                    </button>
            </div>
        </div>
        </div>

        <div class = "mb-3 row">

          <div class = "col-sm-8">
              <div class="mail d-flex">
                  <Label class = "labelcampo">
                      E-mail
                  </Label>

                      <input class="form-control" type="text" placeholder="ex: adoaldogmail@gmail.com.br" id="email_mot" required>

              </div>
          </div>

      </div>

  <div class="mb-3 row justify-content-between">
      <div class = "col-sm-5">
        <div class="d-flex date">
          <Label class = "labelcampo">
              Data de Nascimento
          </Label>

                <input class="form-control" type="date" placeholder="" id ="dt_nasc_mot" required>

        </div>
    </div>
    <div class = "col-sm-4">
      <div >
        <Label class = "labelcampo">
            Telefone
        </Label>
          <form role = "search">
              <input class="form-control w-100" type="text" placeholder="ex: (11) 98245-3140" maxlength="11" id="fone_mot" required>
          </form>
      </div>
  </div>
  </div>

  <div class="mb-3 row">
      <div class = "col-sm-8">
        <div class="register d-flex">
          <label class = "labelcampo">
              CPF
          </label>

                <input class="form-control" type="text" placeholder="ex: 000.000.000-00" id="cpf_mot" maxlength="11" required>

        </div>
    </div>
  </div>

  </div>
</div>


<div class ="container" >

<div class = "box" style="width: 100%;">
  <div class="container" styte="width: 100px; height: 100px">
    <div id="apresentar-imagem"></div>
  </div>
</div>
<div class="row">
  <div style="align-items: center;">
    <input type="file" id="imagem-usuario" onchange="converterImagem();" />
  </div>
</div>
<br>
<div class="row">



  <div class ="item">
    <button style="background-color:#003050; color: #ffffff;" type="button" class="btn" style="background-color: #071d29;" onclick="excluir()">Excluir</button>
  </div>

  <div class ="item">
    <button  style="background-color:#cadd08; color: #ffffff;" type="button" class="btn" onclick="editar()">Editar</button>
  </div>

  <div class ="item">
    <button style="background-color:#00a6b6; color: #ffffff;" type="button" class="btn" onclick="gravar()">Inserir</button>
  </div>

</div>



  </div>
</div>


</section>
</main>
<footer>
  © ETEC Atibaia - Todos os direitos reservados
</footer>
  <script  src="../assets/js/script.js"></script>

<script>
  // Funcao converter imagem para base64
  function converterImagem() {

// Receber o arquivo do formulario
var receberArquivo = document.getElementById("imagem-usuario").files;
console.log(receberArquivo);
// Verificar se existe o arquivo
if (receberArquivo.length > 0) {
  // Carregar a imagem
  var carregarImagem = receberArquivo[0];
  console.log(carregarImagem);
  // FileReader - permite ler o conteudo do arquivo do computador do usuario
  var lerArquivo = new FileReader();
  // O evento onload ocorre quando um objeto he carregado
  lerArquivo.onload = function (arquivoCarregado) {
    // Converter a imagem para base64
    imagemBase64 = arquivoCarregado.target.result;
    //console.log(imagemBase64);
    //**** INICIO ENVIAR IMAGEM PARA O HTML *****/
    // Cria o elemento HTML
    novaImagem = document.createElement('img');
    novaImagem.src = imagemBase64;
    novaImagem.style = "width:100%;height:380px;";
    //**** FIM ENVIAR IMAGEM PARA O HTML *****/
    // Enviar imagem para o HTML
    document.getElementById("apresentar-imagem").innerHTML = novaImagem.outerHTML;
    // Recuperar a imagem base64 do HTML
    //console.log(document.getElementById("apresentar-imagem").innerHTML);
  }
  // O metodo readAsDataURL e usado para ler o conteudo
  lerArquivo.readAsDataURL(carregarImagem);
}
}

  function editar(){
    var ra = document.getElementById("RA_mot").value;
  var nome = document.getElementById("nome_mot").value;
  var cpf = document.getElementById("cpf_mot").value;
  var fone = document.getElementById("fone_mot").value;
  var email = document.getElementById("email_mot").value;
  var dt_nasc = document.getElementById("dt_nasc_mot").value;

  var url = "";

  url = '../php/edt_mot.php?RA_mot=' + ra + '&nome_mot=' + nome + '&cpf_mot=' + cpf + '&fone_mot=' +
   fone + '&email_mot=' + email + '&dt_nasc=' + dt_nasc

   fetch(url)
                .then((response) => response.json())               
                .then((data) => {
                  msg = data.mensagem;
                  alert(msg);
                  $("#nome_mot").val("");
                  $("#cpf_mot").val("");
                  $("#fone_mot").val("");
                  $("#email_mot").val("");
                })
                setTimeout(function() { location. reload(); }, 200);
  }

function select(){

  $("#nome_mot").val("carregando...");
  $("#cpf_mot").val("carregando...");
  $("#fone_mot").val("carregando...");
  $("#email_mot").val("carregando...");
  $("#dt_nasc_mot").val("carregando...");

  var ra = document.getElementById("RA_mot").value;

  var url = "";

  url = '../php/motoristas.php?RA_mot=' + ra

   fetch(url)
                .then((response) => response.json())
                .then((data) => {
              
                  for(let item in data){
                    $("#ra_mot").val(data[item].tb06_RA);
                    $("#nome_mot").val(data[item].tb06_nome);
                    $("#cpf_mot").val(data[item].tb06_cpf);
                    $("#fone_mot").val(data[item].tb06_fone);
                    $("#email_mot").val(data[item].tb06_email);
                    $("#dt_nasc_mot").val(data[item].tb06_dt_nasc);
                  }
})
}

function gravar(){

  var ra = document.getElementById("RA_mot").value;
  var nome = document.getElementById("nome_mot").value;
  var cpf = document.getElementById("cpf_mot").value;
  var fone = document.getElementById("fone_mot").value;
  var email = document.getElementById("email_mot").value;
  var dt_nasc = document.getElementById("dt_nasc_mot").value;
  var foto = imagemBase64;
  var url ="";
  url = '../php/inserir_mot.php'

const formData = new FormData();
formData.append("RA_mot", ra);
formData.append("nome_mot", nome);
formData.append("cpf_mot", cpf);
formData.append("fone_mot", fone);
formData.append("email_mot", email);
formData.append("dt_nasc_mot", dt_nasc);
formData.append("foto", foto);

fetch(url, {
        method: "POST", 'Content-Type': 'application/x-www-form-urlencoded',
        body: formData
      })
      
      .then((response) => response.json())
        .then((data) => {
      
          msg = data.mensagem;
          alert(msg);
          $("#RA_mot").val("");
          $("#nome_mot").val("");
          $("#cpf_mot").val("");
          $("#fone_mot").val("");
          $("#email_mot").val("");
          $("#dt_nasc_mot").val("");
          novaImagem.src = "";
          novaImagem.style = "";
          document.getElementById("apresentar-imagem").innerHTML = novaImagem.outerHTML
        })
        setTimeout(function() { location. reload(); }, 200);
    }

function excluir() {

  var ra = document.getElementById("RA_mot").value;

var url = "";

url = '../php/excluir_mot.php?RA_mot=' + ra

 fetch(url)
              .then((response) => response.json())
              .then((data) => {
      
      msg = data.mensagem;
      alert(msg);
      $("#RA_mot").val("");
      $("#nome_mot").val("");
      $("#cpf_mot").val("");
      $("#fone_mot").val("");
      $("#email_mot").val("");
      $("#dt_nasc_mot").val("");
      novaImagem.src = "";
      novaImagem.style = "";
      document.getElementById("apresentar-imagem").innerHTML = novaImagem.outerHTML
    })
    setTimeout(function() { location. reload(); }, 200);
        }
</script>

</body>
<script src="../assets/js/menu.js"></script>
</html>
