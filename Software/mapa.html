<!DOCTYPE html>
<html>

<head>

    <meta charset='utf-8'>
    <meta name="author" content="etec-c">
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>

    <title>Mapa e Pontos</title>

    <script src="https://kit.fontawesome.com/c8de44c573.js" crossorigin="anonymous"></script>
    <link rel="icon" href="../images/bushubico.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="./assets/css/starter.css">

    <link href="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
    <style>
        @font-face {
            font-family: Made Tommy;
            src: url(Madetommy.otf);
        }
        .mapboxgl-popup {
        width: 700px;
        height: 300px;
        }
        .mapboxgl-popup-content {
        text-align: center;
        font-family: 'Open Sans', sans-serif;
        color:black;
        }

    </style>

</head>

<body class="mapa">
  <header>
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container-fluid">
         <a href="../index.html">
           <img src="images/icone_v1.png" width="35" height="45" class="d-inline-block align-top" alt="">
         </a>

         <div class="container text-center grid gap-0 column-gap-3 menu-desktop d-none d-lg-flex">
           <div class="row align-items-start">

             <div class="col g-col-6">
               <li class="nav-item list-unstyled">
                 <a class="nav-link active text-white" aria-current="page" href="mapa.html">Mapa</a>
               </li>
             </div>

             <div class="col g-col-6">
               <li class="nav-item list-unstyled">
                 <a class="nav-link active text-white" aria-current="page" href="linhas.html">Linhas</a>
               </li>
             </div>

             <div class="col g-col-6">
               <li class="nav-item list-unstyled">
                 <a class="nav-link active text-white" href="horarios.html">Horários</a>
               </li>
             </div>
           </div>
         </div>

        <button class="navbar-toggler" type="button" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
         </button>
        </ul>
      </div>
      </div>

    </nav>
  </header>



<main>
  <div class="section">
    <div class="mapa" style="width: 100%;">
      <p style ="font-size:25px;max-height: 20px; text-align: center;"> Pontos de ônibus</p>

    <div class="superior" style=" width: 100%;height:500px; float:left;">
      <div id="map"></div>
    </div>

    </div>

  </div>
</main>
<footer>
  <div class="content">
    © ETEC Atibaia - Todos os direitos reservados
  </div>
</footer>
<div class="mobile-menu position-fixed">
  <div class="row align-items-start">
    <div class="close-item">
      <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px" baseProfile="basic"><path d="M37,45c-0.256,0-0.512-0.098-0.707-0.293L24,32.414L11.707,44.707c-0.391,0.391-1.023,0.391-1.414,0l-5-5	C5.105,39.52,5,39.265,5,39v-2c0-0.294,0.129-0.573,0.354-0.763l12.17-10.298L5.293,13.707C5.105,13.52,5,13.265,5,13v-2	c0-0.351,0.184-0.677,0.485-0.857l5-3c0.394-0.235,0.898-0.173,1.222,0.15L24,19.586L36.293,7.293	c0.324-0.324,0.829-0.386,1.222-0.15l5,3C42.816,10.323,43,10.649,43,11v2c0,0.265-0.105,0.52-0.293,0.707L30.476,25.938	l12.17,10.298C42.871,36.427,43,36.706,43,37v2c0,0.265-0.105,0.52-0.293,0.707l-5,5C37.512,44.902,37.256,45,37,45z"/><polygon fill="#fff" points="42,37 29,24 42,11 37,6 24,19 11,6 6,11 19,24 6,37 11,42 24,29 37,42"/><path d="M37,43c-0.256,0-0.512-0.098-0.707-0.293L24,30.414L11.707,42.707c-0.391,0.391-1.023,0.391-1.414,0l-5-5	c-0.391-0.391-0.391-1.023,0-1.414L17.586,24L5.293,11.707c-0.391-0.391-0.391-1.023,0-1.414l5-5c0.391-0.391,1.023-0.391,1.414,0	L24,17.586L36.293,5.293c0.391-0.391,1.023-0.391,1.414,0l5,5c0.391,0.391,0.391,1.023,0,1.414L30.414,24l12.293,12.293	c0.391,0.391,0.391,1.023,0,1.414l-5,5C37.512,42.902,37.256,43,37,43z M24,28c0.256,0,0.512,0.098,0.707,0.293L37,40.586L40.586,37	L28.293,24.707c-0.391-0.391-0.391-1.023,0-1.414L40.586,11L37,7.414L24.707,19.707c-0.391,0.391-1.023,0.391-1.414,0L11,7.414	L7.414,11l12.293,12.293c0.391,0.391,0.391,1.023,0,1.414L7.414,37L11,40.586l12.293-12.293C23.488,28.098,23.744,28,24,28z"/></svg>
    </div>
    <div class="col g-col-6">
      <li class="nav-item list-unstyled">
        <a class="nav-link active text-white" aria-current="page" href="mapa.html">Mapa</a>
      </li>
    </div>

    <div class="col g-col-6">
      <li class="nav-item list-unstyled">
        <a class="nav-link active text-white" aria-current="page" href="linhas.html">Linhas</a>
      </li>
    </div>

    <div class="col g-col-6">
      <li class="nav-item list-unstyled">
        <a class="nav-link active text-white" href="horarios.html">Horários</a>
      </li>
    </div>

  </div>
</div>

<script>

	mapboxgl.accessToken = 'pk.eyJ1IjoiYnVzaHViIiwiYSI6ImNsaXZvem04ODA5dXkzaGxtbXBvYWVnODYifQ.3eOoXhU-ZDfK_nnBzf6_fg';


  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition)
  } else {
    console.log("Geolocation is not supported by this browser.")
  }

function showPosition(position) {

    const map = new mapboxgl.Map({
        container: 'map', // container ID
        // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
        style: 'mapbox://styles/mapbox/streets-v12', // style URL
        center: [position.coords.longitude, position.coords.latitude], // starting position [lng, lat]
        zoom: 14 // starting zoom
    });

        var url = 'php/dadospontos.php'

    fetch(url)
        .then((response) => response.json())
        .then((data) => {
            console.log(data)
            for (let item in data.features) {
              const el = document.createElement('div');
el.className = 'marker';
                var ponto = new mapboxgl.Marker()
                .setLngLat([data.features[item].geometry.coordinates[0], data.features[item].geometry.coordinates[1]])
                .setPopup(
                new mapboxgl.Popup({ offset: 10 }) // add popups
                .setHTML(
                `<h4>${data.features[item].properties.name}</h4>
                <p style = "color: black;">${data.features[item].properties.description}</p>
                <img src="images/location.png">
                <p style = "color: black;font-size:15px;">${data.features[item].properties.localizacao}</p>`
                )
                )
                .addTo(map);

            }
        })

}

</script>

</body>
<script src="./assets/js/menu.js"></script>

<style>
  @font-face {
      font-family: Made Tommy;
      src: url(Madetommy.otf);
  }
</style>

</html>
